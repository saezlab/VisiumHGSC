from snakemake.utils import min_version
min_version("6.0")

configfile: "config/config.yaml"

rule all:
    input:
    #    expand("results/integrated/{split_type}_int.RDS", split_type = ['plate']),
    #    expand("plots/integration/{split_type}_umaps.pdf", split_type = ['plate']),
       'plots/structural/plate/cell2location_umap.pdf',
       expand('results/functional/plate/activities_{network}.csv', network = ['pathways', 'cytokines']),
       'plots/functional/plate/pathways.pdf',
       'plots/structural/cell_density.pdf',
       'plots/structural/cell2location_proportions.pdf',
       expand('plots/functional/plate/{view_type}_paraviews.pdf', view_type = ['celltype']),
       expand('plots/Misty/{view_type}_misty.pdf', view_type = ['celltype']),
       expand('plots/Misty/{view_type}_interaction_correlations.pdf', view_type = ['celltype']),
       'plots/structural/plate/COI.pdf'



module preprocess:
    snakefile: 'rules/preprocessing_seurat.smk'
    config: config

use rule * from preprocess as PP_*

module functional:
    snakefile: 'rules/functional.smk'
    config: config

use rule * from functional as Fun_*

module structural:
    snakefile: 'rules/structural.smk'
    config: config

use rule * from structural as St_*

module misty:
    snakefile: 'rules/misty.smk'
    config: config

use rule * from misty as M_*
